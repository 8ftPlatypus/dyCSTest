---
unit: base
name: "_{Pathfinder 2nd Edition}"

form:
  - select: ancestry
    name: "_{Ancestry}"
    max: 1
  - select: background
    name: "_{Background}"
    max: 1
  - select: class
    name: "_{Class}"
    max: 1
  - select: archetype
    name: "_{Archetype}"
    max: 3

  - option: build
    name: "_{Build A Character}"
    unit: option/build
  - option: minis
    name: "_{Map Minis}"
    unit: option/minis
  - option: permission
    name: "_{Permission to Print}"
    unit: option/permission
  - select: inventory
    name: "_{Inventory}"
    max: 1
    default: half

inc:

  - at: '@permission'
    add:
      - hr:
      - h6: _{This document uses trademarks and/or copyrights owned by Paizo Publishing,
          LLC, which are used under Paizo's Community Use Policy. We are expressly
          prohibited from charging you to use or access this content. This document
          is not published, endorsed, or specifically approved by Paizo Publishing.}
      - p: https://paizo.com/paizo/about/communityuse

  - at: '@pages'
    add:

      - page: cover
        name: "_{Cover}"
        order: 4
        flex: true
        contents:
          - layout: 2e
            contents:
              - g:
                contents:
                  - logo:
                  - section:
                    id: player
                    untitled: true
                    contents:
                      - row:
                        contents:
                          - field: player-name
                            label: "_{Player}"
                            width: stretch
                            align: left
                          - field: hero-points
                            label: "_{Hero Points}"
                            border: circle
                            size: huge


                      - row:
                        contents:
                          - field: campaign-name
                            label: "_{Campaign}"
                            width: stretch
                            align: left
                          - field: xp
                            label: "_{XP}"
                            underlay: "_{XP}"
                            width: large
                            border: full
                  - hr:
                    swash: true
                  - portrait: personal
                  - section: "_{Character}"
                    id: character
                    untitled: true
                    contents:
                      - list:
                        zebra: true
                        hr: true
                        contents:
                          - g:
                            contents:
                              - field: character-name
                                legend: "_{Character Name}"
                                size: huge
                                width: stretch
                                align: left
                              - layout: alignment
                                contents:
                                  - g:
                                    contents:
                                      - row:
                                        contents:
                                          - field: gender
                                            label: "_{Gender}"
                                            icon: gender
                                            width: huge
                                          - spacer:
                                          - field: age
                                            label: "_{Age}"
                                            width: huge
                                          - spacer:
                                          - field: size
                                            label: "_{Size}"
                                            icon: size
                                            width: huge
                                          - spacer:
                                      - field: deity
                                        label: "_{Deity}"
                                        width: stretch
                                  - field: alignment
                                    frame: none
                                    control: alignment
                          - g:
                            contents:
                              - h5: "_{Abilities}"
                              - layout: 6e
                                gutter: none
                                contents:
                                  - repeat: 6
                                    rows:
                                      - name: "_{Strength}"
                                        short: "_{STR}"
                                        code: STR
                                      - name: "_{Dexterity}"
                                        short: "_{DEX}"
                                        code: DEX
                                      - name: "_{Constitution}"
                                        short: "_{CON}"
                                        code: CON
                                      - name: "_{Intelligence}"
                                        short: "_{INT}"
                                        code: INT
                                      - name: "_{Wisdom}"
                                        short: "_{WIS}"
                                        code: WIS
                                      - name: "_{Charisma}"
                                        short: "_{CHA}"
                                        code: CHA
                                    contents:
                                      - g:
                                        valign: top
                                        contents:
                                          - row: center
                                            contents:
                                              - spacer:
                                              - field: "#{code}"
                                                label: "#{name}"
                                                border: circle
                                                size: huge
                                                underlay: "#{short}"
                                                eq: "(%{#{code}-score}-10)/2"
                                              - spacer:
                                          - row: center
                                            contents:
                                              - field: "key-ability"
                                                control: radio
                                                frame: none
                                                value: "#{code}"
                                          - row: center
                                            contents:
                                              - spacer:
                                              - field: "#{code}-score"
                                                frame: none
                                              - spacer:
                              - p: "_{Ability Modifier = (Ability Score - 10) &divide; 2}"
                                align: left

                          - g:
                            contents:
                              - h5: "_{Proficiency}"
                              - row: split
                                valign: top
                                contents:
                                  - g:
                                    valign: top
                                    contents:
                                      - field: proficiency-untrained
                                        label: "_{Untrained}"
                                        output: true
                                        control: proficiency
                                        value: 0
                                      - label: "_{None}"
                                        align: center
                                  - g:
                                    valign: top
                                    contents:
                                      - field: proficiency-trained
                                        label: "_{Trained}"
                                        output: true
                                        control: proficiency
                                        value: trained
                                      - label: "_{Level}\n+2"
                                        align: center
                                  - g:
                                    valign: top
                                    contents:
                                      - field: proficiency-expert
                                        label: "_{Expert}"
                                        output: true
                                        control: proficiency
                                        value: expert
                                      - label: "_{Level}\n+4"
                                        align: center
                                  - g:
                                    valign: top
                                    contents:
                                      - field: proficiency-master
                                        label: "_{Master}"
                                        output: true
                                        control: proficiency
                                        value: master
                                      - label: "_{Level}\n+6"
                                        align: center
                                  - g:
                                    valign: top
                                    contents:
                                      - field: proficiency-legendary
                                        label: "_{Legendary}"
                                        output: true
                                        control: proficiency
                                        value: legendary
                                      - label: "_{Level}\n+8"
                                        align: center
                  - tail:
              - g:
                contents:
                  - section: "_{Character}"
                    id: ancestry
                    contents:
                      - list:
                        hr: true
                        zebra: true
                        avoid-shade: true
                        contents:
                          - g:
                            contents:
                              - field: ancestry
                                legend: "_{Ancestry}"
                                width: stretch
                                # value: '#{ancestry}'
                              - field: cover-heritage
                                label: "_{Heritage}"
                                width: stretch
                                merge-bottom: true

                          - g:
                            contents:
                              - field: char-background
                                legend: "_{Background}"
                                width: stretch
                                merge-bottom: true
                                # value: '#{background}'

                          - g:
                            contents:
                              - row:
                                contents:
                                  - field: cover-class
                                    width: stretch
                                    legend: "_{Class}"
                                    # value: '#{class}'
                                  - field: cover-level
                                    label: "_{Level}"
                                    border: full
                              - field: class-specialisation
                                label: "_{Subclass}"
                                width: stretch
                                merge-bottom: true

                          - g:
                            contents:
                              - h5: "_{Archetypes}"
                              - list:
                                collapse: true
                                zebra: true
                                contents:
                                  - repeat: 3
                                    field_frame: none
                                    merge-bottom: true
                                    contents:
                                      - row:
                                        contents:
                                          - field: archetype-#{i}-name
                                            width: stretch
                                            align: left
                                            frame: none
                                          - field: archetype-#{i}-feats
                                            frame: none
                                            control: progression
                                            parts:
                                              - control: checkbox
                                              - control: checkbox
                                              - control: checkbox
                              - p: "_{You must take three archetype feats before you can start another.}"
                              # - p: "You cannot have more than one prestige archetype."

                      - zone: '@advancement'
                        contents:
                          - section: "_{Advancement}"
                            contents:
                              - advancement:
                                labels:
                                  - "_{Ancestry}, _{Heritage}, _{Background}, _{initial proficiencies}"
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - "_{Master in skills}"
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - "_{Legendary in skills}"
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                  - ""
                                fields:
                                  - id: ancestry-feat
                                    label: "_{Ancestry\nfeat}"
                                    levels: [ 1, 5, 9, 13, 17 ]
                                    shade: true
                                  - id: general-feat
                                    label: "_{General\nfeat}"
                                    levels: [ 3, 7, 11, 15, 19 ]
                                  - id: class-feat
                                    label: "_{Class\nfeat}"
                                    levels: [ 1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20 ]
                                    shade: true
                                  - id: skill-feat
                                    label: "_{Skill\nfeat}"
                                    levels: [ 1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20 ]
                                  - id: skill-increase
                                    label: "_{Skill\nincrease}"
                                    levels: [ 3, 5, 7, 9, 11, 13, 15, 17, 19 ]
                                    shade: true
                                  - id: ability-boost
                                    label: "_{Ability\nboost}"
                                    levels: [ 5, 10, 15, 20 ]
                                    template:
                                      field: '#{id}'
                                      frame: none
                                      control: checkbox

                  - tail:
                  - spacer:


      - page: skills
        name: "_{Skills}"
        order: 5
        flex: true
        contents:
          - layout: 2l
            contents:
              - g:
                contents:

                  - section: "_{Skill feats}"
                    id: skill-feats
                    contents:
                      - zone: '@skill-feats-section'
                        contents:
                          - list:
                            zebra: true
                            hr: true
                            avoid-shade: true
                            contents:
                              - article: 'skill-feat-#{level}'
                                lines: 1
                                annotation: "_{Background}"
                              - each:
                                template:
                                  - level: "#{level}"
                                    contents:
                                      - item: yes
                                contents:
                                  - slots: [ 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, '' ]
                                    min: 1
                                    max: 1
                                    placeholder:
                                      article: 'skill-feat-#{level}'
                                      lines: 2
                                    contents:
                                      - zone: '@skill-feats'

                              - field: skill-notes
                                flex: small
                                width: stretch
                                legend: "_{Skill Notes}"
                                repeat: 6
                                merge-bottom: true

                          # - zone: '@language-section'
                          #   contents:
                          #     - section: "Languages"
                          #       id: languages
                          #       contents:
                          #         - field: languages
                          #           frame: none
                          #           repeat: 4
                          #           align: left
                          #           width: stretch
                          #           merge-bottom: true

                          - tail:
                          - spacer:

              - g:
                contents:
                  - section: "_{Ancestry}"
                    contents:
                      - list:
                        hr: true
                        zebra: true
                        columns: 2
                        contents:
                          - g:
                            contents:
                              - article: heritage
                                lines: 1
                                annotation: "_{Heritage}"
                          - each:
                            template:
                              - level: '#{level}'
                                contents:
                                  - item: yes
                            contents:
                              - slots: [ 1, 5, 9, 13, 17 ]
                                min: 1
                                max: 1
                                contents:
                                  - zone: '@ancestry-feats'
                                placeholder:
                                  - article: 'ancestry-feat-#{i}'
                                    lines: 1

                  - section: "_{General Feats}"
                    contents:
                      - list:
                        columns: 2
                        zebra: true
                        hr: true
                        contents:
                          - each:
                            template:
                              - level: "#{level}"
                                contents:
                                  - item: yes
                            contents:
                              - slots: [ 3, 7, 11, 15, 19 , '' ]
                                min: 1
                                max: 1
                                placeholder:
                                  article: general-feat-level-#{level}
                                  lines: 2
                                contents:
                                  - zone: '@general-feats'

                  - section: "_{Skills}"
                    id: skills
                    flex: tiny
                    contents:
                      - table:
                        collapse: true
                        zebra: true
                        field_frame: none
                        sort_by: name
                        columns:
                          -
                          - label: "_{Assurance}"
                            align: right
                          - "_{Skill\nBonus}"
                          -
                          - "_{Ability\nModifier}"
                          - "_{Proficiency}"
                          - "_{Feats\nMisc}"
                          - "_{Armour\nCheck\nPenalty}"
                        rows:
                          # - zone: '@skills'
                          #   contents:
                          - skill: acrobatics
                            name: "_{Acrobatics}"
                            ability: "_{DEX}"
                            abilityref: DEX
                            acp: true
                          - skill: arcana
                            name: "_{Arcana}"
                            ability: "_{INT}"
                            abilityref: INT
                            acp: false
                          - skill: athletics
                            name: "_{Athletics}"
                            ability: "_{STR}"
                            abilityref: STR
                            acp: true
                          - skill: crafting
                            name: "_{Crafting}"
                            ability: "_{INT}"
                            abilityref: INT
                            acp: false
                          - skill: deception
                            name: "_{Deception}"
                            ability: "_{CHA}"
                            abilityref: CHA
                            acp: false
                          - skill: diplomacy
                            name: "_{Diplomacy}"
                            ability: "_{CHA}"
                            abilityref: CHA
                            acp: false
                          - skill: intimidation
                            name: "_{Intimidation}"
                            ability: "_{CHA}"
                            abilityref: CHA
                            acp: false
                          - skill: medicine
                            name: "_{Medicine}"
                            ability: "_{WIS}"
                            abilityref: WIS
                            acp: false
                          - skill: nature
                            name: "_{Nature}"
                            ability: "_{WIS}"
                            abilityref: WIS
                            acp: false
                          - skill: occultism
                            name: "_{Occultism}"
                            ability: "_{INT}"
                            abilityref: INT
                            acp: false
                          - skill: performance
                            name: "_{Performance}"
                            ability: "_{CHA}"
                            abilityref: CHA
                            acp: false
                          - skill: religion
                            name: "_{Religion}"
                            ability: "_{WIS}"
                            abilityref: WIS
                            acp: false
                          - skill: society
                            name: "_{Society}"
                            ability: "_{INT}"
                            abilityref: INT
                            acp: false
                          - skill: stealth
                            name: "_{Stealth}"
                            ability: "_{DEX}"
                            abilityref: DEX
                            acp: true
                          - skill: survival
                            name: "_{Survival}"
                            ability: "_{WIS}"
                            abilityref: WIS
                            acp: false
                          - skill: thievery
                            name: "_{Thievery}"
                            ability: "_{DEX}"
                            abilityref: DEX
                            acp: true
                            fade: false
                          - skill: lore
                            name: "_{Lore}"
                            ability: "_{INT}"
                            abilityref: INT
                            acp: false
                            fade: true
                          - skill: ''
                            name: ''
                            ability: ''
                            acp: false
                          - skill: ''
                            name: ''
                            ability: ''
                            acp: false
                          - skill: ''
                            name: ''
                            ability: ''
                            acp: false
                        template:
                          - h6: "#{name}"
                            fade: "#{fade}"
                          - field: "#{skill}-assurance"
                            control: checkbox
                            align: right
                          - field: "#{skill}-bonus"
                            border: full
                            icon: bonus
                          - span: "="
                          - field:
                            ref: "#{abilityref}"
                            underlay: "#{ability}"
                            frame: h-label
                            label: "#{ability}"
                          - field: "#{skill}-proficiency"
                            control: proficiency
                          - field: "#{skill}-misc"
                            misc: true
                          - field: "#{skill}-acp"
                            ref: acp
                            border: full
                            exists: "#{acp}"
                            prefix: "&ndash;"
                  - section: "_{Perception}"
                    flex: small
                    contents:
                      - row:
                        contents:
                          - calc:
                            output:
                              field: perception
                              # frame: left
                              icon: bonus
                              legend: "_{Perception}"
                              width: large
                              eq: '%{WIS}+%{perception-proficiency}+%{perception-item-bonus}+%{perception-misc}'
                            inputs:
                              - field:
                                ref: "WIS"
                                underlay: "_{WIS}"
                                label: "_{WIS}"
                              - span: "+"
                              - field: perception-proficiency
                                label: "_{Proficiency}"
                                control: proficiency
                              - span: "+"
                              - field: perception-item-bonus
                                label: "_{Item}"
                              - span: "+"
                              - field: perception-misc
                                misc: true
                                label: "_{Misc}"
                      - row: left
                        contents:
                          - field: perception-low-light
                            frame: right
                            control: checkbox
                            label: "_{Low-light vision}"
                          - field: perception-darkvision
                            frame: right
                            control: checkbox
                            label: "_{Dark vision}"
                          - field: perception-scent
                            frame: right
                            control: checkbox
                            label: "_{Scent}"
                      # - field: perception-other
                      #   label: "Conditional"
                      #   align: left
                      #   width: stretch
                      #   merge-bottom: true
                      #   repeat: 2
                  - tail:

      - page: combat
        name: "_{Combat}"
        order: 6
        flex: true
        contents:
          - layout: 2l
            contents:
              - g:
                contents:
                
                  - section: "_{Class DC}"
                    id: class-dc
                    contents:
                      - calc:
                        output:
                          field: class-dc
                          legend: "#{class}"
                          underlay: "_{DC}"
                          width: large
                          icon: dc
                          eq: '%{#{key-ability}}+%{level}+%{class-dc-item-bonus}'
                        inputs:
                          - zone: '@key-ability-field'
                            contents:
                              - field:
                                label: "_{Key Ability}"
                                ref: key-ability
                          - span: "+"
                          - field: class-dc-proficiency
                            label: "_{Proficiency}"
                            control: proficiency
                          - span: "+"
                          - field: class-dc-item-bonus
                            label: "_{Item}"
                      - calc:
                        output:
                          field: class-dc-other
                          underlay: "_{DC}"
                          label: "_{Archetype}"
                          width: large
                          icon: dc
                          eq: '%{#{key-ability}}+%{level}+%{class-dc-item-bonus}'
                        inputs:
                          - zone: '@key-ability-field'
                            contents:
                              - field:
                                label: "_{Key Ability}"
                                ref: key-ability
                          - span: "+"
                          - field: class-dc-other-proficiency
                            label: "_{Proficiency}"
                            control: proficiency
                          - span: "+"
                          - field: class-dc-other-item-bonus
                            label: "_{Item}"
                  - section: "_{Speed}"
                    id: speed
                    contents:
                      - layout: 3e
                        contents:
                          - action: 1
                            contents:
                              - p: "_{Stride}"
                          - field: speed
                            legend: "_{Speed}"
                            control: speed
                            output: true
                            width: stretch
                          - field: speed-armour
                            label: "_{Speed in Armour}"
                            control: speed
                            width: stretch
                          # - field: speed-temp
                          #   label: "_{Temp Speed}"
                          #   control: speed
                          #   output: true
                          #   temp: true
                      - layout: 3e
                        contents:
                          - field: speed-swim
                            label: "_{Swim Speed}"
                            control: speed
                            width: stretch
                          - field: speed-climb
                            label: "_{Climb Speed}"
                            control: speed
                            width: stretch
                          - field: speed-fly
                            label: "_{Fly Speed}"
                            control: speed
                            width: stretch

                  - section: "_{Focus}"
                    contents:
                      - calc:
                        output:
                          field: focus
                          overlay: "_{pts}"
                          width: huge
                          legend: "_{Focus Points}"
                        inputs:
                          - join: '+'
                            contents:
                              - zone: '@focus-points'
                                contents:
                                  - field: focus-base
                                    label: "_{Class}"
                              - field: focus-misc
                                label: "_{Misc}"
                                misc: true
                      # - p: "Maximum focus: 3"
                      - row:
                        contents:
                          - field: current-focus
                            temp: true
                            label: "_{Current Focus Points}"
                            align: center
                            width: stretch
                            border: full
                            overlay: "_{pts}"
                          - field: refocus
                            label: "_{Refocus}"
                            border: full
                            width: large
                            prefix: "+"
                            underlay: "1"
                            overlay: "_{pts}"

                  - section: "_{Saving Throws}"
                    id: saving-throws
                    contents:
                      - table:
                        columns:
                          -
                          -
                          - "_{Ability\nModifier}"
                          - "_{Proficiency}"
                          - "_{Item}"
                          - "_{Misc}"
                        rows:
                          - save: fortitude
                            legend: "_{Fortitude}"
                            short: "_{FORT}"
                            ability: "_{CON}"
                            abilityref: CON
                          - save: reflex
                            legend: "_{Reflex}"
                            short: "_{REF}"
                            ability: "_{DEX}"
                            abilityref: DEX
                          - save: will
                            legend: "_{Will}"
                            short: "_{WILL}"
                            ability: "_{WIS}"
                            abilityref: WIS
                        template:
                          - calc:
                            output:
                              field: "#{save}"
                              legend: "#{legend}"
                              icon: bonus
                              border: full
                              width: large
                              underlay: "#{short}"
                              merge-top: true
                              eq: '%{#{abilityref}}+%{#{save}-proficiency}+%{#{save}-item-bonus}+%{#{save}-misc}'
                            inputs:
                              - field:
                                frame: h-label
                                label: "#{ability}"
                                underlay: "#{ability}"
                                ref: "#{abilityref}"
                              - field: "#{save}-proficiency"
                                control: proficiency
                              - field: "#{save}-item-bonus"
                              - field: "#{save}-misc"
                                misc: true
                      - slots:
                        min: 2
                        merge-bottom: true
                        placeholder:
                          - field: 'saving-throws-conditional-#{i}'
                            frame: none
                            align: left
                            width: stretch
                        contents:
                          - log: 'Saving throws zone'
                          - zone: '@saving-throws-contitional'

              - g:
                contents:
                  - section: "_{Attacks}"
                    id: attacks
                    contents:
                      - list:
                        zebra: true
                        hr: true
                        flex: true
                        avoid-shade: true
                        contents:
                          - row: split
                            contents:
                              - h5: "_{Multi-Attack}"
                              - spacer:
                              - icon: action
                              - field: map-1
                                frame: left
                                label: "_{1st}"
                                output: true
                                width: large
                                underlay: 0
                              - icon: action2nd
                              - field: map-2
                                frame: left
                                label: "_{2nd}"
                                output: true
                                width: large
                                underlay: -5
                              - icon: action3rd
                              - field: map-3
                                frame: left
                                label: "_{3rd}"
                                output: true
                                width: large
                                underlay: -10

                          - repeat: 4
                            contents:
                              - g:
                                contents:
                                  - field: attack-#{i}
                                    width: stretch
                                    frame: none
                                    align: left
                                    size: large
                                  - row:
                                    contents:
                                      - calc:
                                        output:
                                          field: attack-#{i}-bonus
                                          label: "_{Attack Bonus}"
                                          width: huge
                                          attack: true
                                          icon: bonus
                                        inputs:
                                          - field:
                                            ref: true
                                            misc: true
                                            label: "_{Ability}"
                                          - field: attack-#{i}-proficiency
                                            control: proficiency
                                            label: "_{Proficiency}"
                                          - field: attack-#{i}-potency
                                            control: icon
                                            label: "_{Potency}"
                                            icon: quality
                                          # - field: attack-#{i}-potency
                                          #   control: icon
                                          #   label: "Potency"
                                          #   icon: potency
                                      - field: attack-#{i}-damage
                                        output: true
                                        label: "_{Damage}"
                                        width: huge
                                        icon: damage
                                        control: compound
                                        parts:
                                          - subid: ndice
                                            width: tiny
                                            align: right
                                          - label: "_{d}"
                                          - subid: die
                                            width: tiny
                                            align: left
                                          - label: "+"
                                          - subid: extra
                                            width: tiny
                                      - field: attack-#{i}-striking
                                        label: "_{Striking}"
                                        control: icon
                                        icon: quality
                                      - field: attack-#{i}-type
                                        label: "_{Type}"
                                      # - field: attack-#{i}-critical
                                      #   label: "Critical Effect"
                                      #   width: stretch
                                  - field: attack-#{i}-details
                                    frame: none
                                    width: stretch
                                    align: left
                                    merge-bottom: true

                          - layout: 2e
                            contents:
                              - row:
                                contents:
                                  - field: ammo-1-type
                                    legend: "_{Ammo}"
                                    width: stretch
                                    align: left
                                    unlined: true
                                  - field: ammo-1
                                    # frame: h-label
                                    unlined: true
                                    width: small
                                    size: huge
                                    underlay: "#"
                                    label: "_{Charges}"
                                  - field: ammo-1-count
                                    frame: none
                                    control: checkgrid
                                    max: 20
                                    depth: 3
                              - row:
                                contents:
                                  - field: ammo-2-type
                                    width: stretch
                                    align: left
                                    unlined: true
                                  - field: ammo-2
                                    # frame: h-label
                                    unlined: true
                                    width: small
                                    size: huge
                                    underlay: "#"
                                    label: "_{Charges}"
                                  - field: ammo-2-count
                                    frame: none
                                    control: checkgrid
                                    max: 10
                                    depth: 3
          - layout: 2r
            contents:
              - g:
                contents:
                  - section: "_{Health}"
                    id: health
                    contents:
                      - row:
                        layout: split
                        contents:
                          - calc:
                            output:
                              field: hp
                              legend: "_{Hit Points}"
                              icon: hp
                              overlay: "_{hp}"
                              width: large
                              eq: '%{hp-ancestry}+((%{hp-class}+%{CON})*%{level})'
                            inputs:
                              - field: hp-ancestry
                                label: "_{Ancestry}"
                              - span: "+ ("
                              - zone: '@field-class-hp'
                                contents:
                                  - field: hp-class
                                    label: "_{Class}"
                              - span: "+"
                              - field:
                                label: "_{CON}"
                                underlay: "_{CON}"
                                ref: CON
                              - span: ") &times;"
                              - field:
                                ref: level
                                label: "_{Level}"
                              - span: "+"
                              - field:
                                label: "_{Misc}"
                                misc: true
                          - spacer:
                          - field: dying
                            control: progression
                            label: "_{Dying}"
                            parts:
                              - id: dying-1
                                control: checkbox
                              - id: dying-2
                                control: checkbox
                              - id: dying-3
                                control: checkbox
                              - icon: evil
                                size: small
                      - row:
                        contents:
                          - field: current-hp
                            label: "_{Current Hit Points}"
                            border: full
                            temp: true
                            icon: hp
                            overlay: "_{hp}"
                            width: stretch
                          - field: temp-hp
                            label: "_{Temp Hit Points}"
                            border: full
                            temp: true
                            overlay: "_{hp}"
                            width: huge
                          # - field: shield-hp
                          #   label: "Shield Hit Points"
                          #   border: full
                          #   temp: true
                          #   overlay: "hp"
                          #   width: huge

                  - section: "_{Armour Class}"
                    id: armour
                    contents:
                      - row:
                        contents:
                          - calc:
                            output:
                              field: ac
                              legend: "_{Armour Class}"
                              icon: ac
                              border: full
                              width: large
                              underlay: "_{AC}"
                              merge-top: true
                              eq: '10+%{DEX}+%{ac-proficiency}+%{armour-bonus}+%{ac-items}+%{ac-misc}'
                            inputs:
                              - span: 10 +
                              - field:
                                ref: "DEX"
                                underlay: "_{DEX}"
                                label: "_{DEX}"
                              - span: +
                              - field: ac-proficiency
                                control: proficiency
                                label: "_{Proficiency}"
                              - span: +
                              - field: armour-bonus
                                label: "_{Armour\nBonus}"
                              - span: +
                              - field: ac-items
                                label: "_{Items}"
                              - span: +
                              - field: ac-misc
                                label: "_{Misc}"
                                misc: true
                      - layout: 2e
                        contents:
                          - g:
                            contents:
                              - slots:
                                min: 3
                                merge-bottom: true
                                contents:
                                  - zone: '@ac-conditional'
                                placeholder:
                                  - field: "ac-conditional-#{i}"
                                    frame: none
                                    width: stretch

                          - g:
                            contents:
                              # - h5: "Shield"
                              - layout: level
                                contents:
                                  - g:
                                  - row:
                                    contents:
                                      - action:
                                        contents:
                                          - p: "_{Raise shield}"
                                      - field: shield-ac
                                        label: "_{Shield Bonus}"
                                        # icon: ac
                                        border: full
                                        width: large
                              - selectable: 'raise-shield'
                                contents:
                                  - row:
                                    contents:
                                      - action: reaction
                                        contents:
                                          - row:
                                            contents:
                                              - p: "_{Raise shield}"
                                      - field: shield-hp
                                        label: "_{Shield Hit Points}"
                                        border: full
                                        temp: true
                                        overlay: "_{hp}"
                                        width: large

                  - section: "_{Proficiencies}"
                    contents:
                      - list:
                        zebra: true
                        collapse: true
                        columns: 2
                        merge-bottom: true
                        field_frame: none
                        contents:
                          - repeat: 10
                            contents:
                              - row:
                                contents:
                                  - field: "proficiency-#{i}-value"
                                    control: icon
                                    icon: proficiency
                                  - field: "proficiency-#{i}-name"
                                    frame: none
                                    width: stretch
                                    align: left
                  - tail:

              - g:
                contents:
                  - section: "_{Actions}"
                    id: actions
                    contents:
                      - list:
                        zebra: true
                        flex: true
                        hr: true
                        contents:
                          - slots:
                            min: 6
                            max: 6
                            placeholder:
                              article:
                              header:
                                - row:
                                  contents:
                                    - icon: action-template
                                    - field: action-#{i}
                                      frame: none
                                      width: stretch
                                      align: left
                              contents:
                                - field: action-#{i}-details
                                  width: stretch
                                  frame: none
                                  align: left
                                  repeat: 2
                            contents:
                              - zone: '@actions'
                  - tail:
