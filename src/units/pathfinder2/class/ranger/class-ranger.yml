unit: class/ranger
in: class
group: "_{Core Rulebook}"
name: "_{Ranger}"

form:
  - select: ranger/hunters-edge
    name: "_{Hunter's Edge}"
    max: 1
  - select: feat/ranger
    name: "_{Ranger Feats}"
    max: 8
    levels: [ 1, 2, 4, 6, 8, 10, 14, 16, 18, 20 ]

require:
  - unit: option/animal-companion
  - unit: weapon-spec/fast

inc:
  - set: class
    value: "_{Ranger}"
  - set: hp-class
    value: 10
  - set: ranger-class-dc-proficiency
    value: trained

  - set: perception-proficiency
    value: expert
  - set: fortitude-proficiency
    value: expert
  - set: reflex-proficiency
    value: expert
  - set: will-proficiency
    value: trained
  - set: nature-proficiency
    value: trained
  - set: survival-proficiency
    value: trained
    
  - set: unarmoured-proficiency
    value: trained
  - set: light-armour-proficiency
    value: trained
  - set: medium-armour-proficiency
    value: trained

  - at: '@advancement'
    add:
      - level: 1
        class-feat: true
      - level: 1
        gain: "_{Hunter's Edge}"
      - level: 5
        advance: "_{Trackless Step}"
      - level: 9
        advance: "_{Nature's Edge}"
      - level: 11
        advance: "_{Wild Stride}"
      - level: 17
        advance: "_{Masterful Hunter}"
      - level: 19
        advance: "_{Swift Prey}"

  - at: '@saving-throws'
    add:
      - level: 7
        contents:
          - paste: evasion
      - level: 11
        contents:
          - paste: juggernaut
      - level: 15
        contents:
          - paste: improved-evasion

  - at: '@pages'
    add:
      - page: ranger
        name: "_{Ranger}"
        flex: true
        order: 10
        contents:
          - layout: 2l
            contents:
              - g:
                contents:
                  - class-icon: ranger
                  - class-name: "_{Ranger}"

                  - section: "_{Hunter's Edge}"
                    primary: true
                    contents:
                      - list:
                        hr: true
                        contents:
                          - zone: '@ranger/hunters-edge'
                            contents:
                              - g:
                                contents:
                                  - field: ranger-hunters-edge
                                    size: huge
                                    frame: none
                                    width: stretch
                                  - field: ranger-hunters-edge-details
                                    width: stretch
                                    frame: none
                                    repeat: 4
                                    merge-bottom: true
                              - level: 17
                                contents:
                                  - h5: "_{Masterful Hunter}"
                                  - field: ranger-masterful-hunter-details
                                    width: stretch
                                    frame: none
                                    repeat: 3
                                    merge-bottom: true

                  - section: "_{Class DC}"
                    contents:
                      - paste: class-dc
                        params:
                          id: ranger-class-dc
                          legend: "_{Ranger\nClass DC}"

                  - section: "_{Trackless Step}"
                    contents:
                      - level: 5
                        contents:
                          - p: "Gain the benefit of the Cover Tracks action at all times. Anyone tracking you must make a Survival check against your Survival DC."

                  - section: "_{Nature's Edge}"
                    contents:
                      - level: 9
                        contents:
                          - p: "_{Enemies are flat-footed to you (-2 to AC) when in difficult terrain.}"

                  - section: "_{Wild Stride}"
                    contents:
                      - level: 11
                        contents:
                          - p: "_{Ignore non-magical difficult terrain.}"

                  - zone: '@ranger/left'

                  - tail:
                  - spacer:

              - g:
                contents:
                  - section: "_{Hunt Prey}"
                    contents:
                      - list:
                        hr: true
                        contents:
                          - action:
                            contents:
                              - p: "_{Designate a single creature you can see or hear as your target.}"
                              - p: "_{}"
                              - row:
                                contents:
                                  - field: ranger-hunt-prey-perception
                                    border: full
                                    legend: "_{Perception\nBonus}"
                                    prefix: "+"
                                    width: large
                                  - spacer:
                                  - field: ranger-hunt-prey-survival
                                    border: full
                                    legend: "_{Survival\nBonus}"
                                    prefix: "+"
                                    width: large
                                  - p: "_{To Track your prey.}"
                                  - spacer:
                              - p: "_{Ignore the first ranged increment penalty when within second range}"
                          - level: 19
                            contents:
                              - action: free
                                contents:
                                  - h5: "_{Swift Prey}"
                                  - p: "_{Use Hunt Prey as a free action a the start of your turn.}"

                  - zone: '@ranger/right'

                  - paste: class-feats
                    params:
                      id: ranger-feats
                      title: "_{Ranger Feats}"
                      lines: 3
                      slots: [ 1, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20 ]

                  - tail:
                  - spacer:

  - at: '@actions'
    add:
      - action:
        contents:
          - article:
            title: "_{Hunt Prey}"
            content: "_{Pick a single target you can see or hear. Get a bonus to Perception and Track your prey.}"

  - at: '@perception-misc'
    add:
      - field: ranger-hunt-prey-perception
        border: full
        label: "_{Hunt Prey}"
        prefix: "+"
        width: large

